<div class="container mt-5">

    <div class="d-flex justify-content-between align-items-center">
        <h2>Gestión de Usuarios</h2>
        <div>
            <button class="btn btn-primary button-home" (click)="goHome()">Home</button>
            <button class="btn btn-danger button-logout" (click)="logout()">Salir</button>
        </div>
    </div>
    
    <form [formGroup]="userForm" (ngSubmit)="addUser()" class="mb-3">
      <div class="form-row">
        <div class="form-group col-md-4">
          <label for="email">Email</label>
          <input type="email" class="form-control" id="email" name="email" formControlName="email">
        </div>
        <div class="form-group col-md-4">
          <label for="password">Contraseña</label>
          <input type="password" class="form-control" id="password"  name="password" formControlName="chain">
        </div>
        <div class="form-group col-md-4">
          <label for="role">Rol</label>
          <select id="role" class="form-control" name="role" formControlName="role">
            <option value="" selected disabled>Seleccionar rol...</option>
            <option value="ADMIN">ADMIN</option>
            <option value="GENERAL">GENERAL</option>
          </select>
        </div>
      </div>
      <button type="submit" class="btn btn-primary mt-3">Agregar Usuario</button>
      @if(errorAddUser){
        <div class="alert alert-danger mt-3" role="alert">
            {{ errorAddUser }}
        </div>
    }
    </form>
    <div>
        <table class="table table-striped mt-4">
            <thead>
              <tr>
                <th>Email</th>
                <th>Contraseña</th>
                <th>Rol</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
                
            @for(user of users; track $index){
              <tr>
                <td>{{ user.email }}</td>
                <td>
                  <input type="password" class="form-control" [(ngModel)]="user.chain" [disabled]="!user.editing">
                </td>
                <td>
                  <select class="form-control" [(ngModel)]="user.role" [disabled]="!user.editing">
                    <option value="ADMIN">ADMIN</option>
                    <option value="GENERAL">GENERAL</option>
                  </select>
                </td>
                <td>
                  <button class="btn btn-success" (click)="editUser(user, true)" >Editar</button>
                  @if(user.editing){
                    <button class="btn btn-warning" (click)="updateUser(user)" >Guardar</button>
                  }
                  @if(!user.editing){
                  <button class="btn btn-danger" (click)="deleteUser(user)">Eliminar</button>
                  }
                  @if(user.editing){
                  <button class="btn btn-secondary" (click)="editUser(user, false)">Cancelar</button>
                  }
                </td>
              </tr>
            }
            </tbody>
          </table>
    </div>
</div>
  